% function orbitaltrajectory()
%
%This is a function by Alexander Winkles that will model the orbit of a 
% satellite around Earth. 
%
% Inputs
% r : the initial position vector
% v : the initial velocity vector
% t : time since Jan 1, 2000
%
% Outputs
%
%

function orbitaltrajectory(rvec,vvec,t)

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Constants utilized throughout the function        %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

mu = 398.6004418e12; % planetary gravitational constant (m^3 / s^2)


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Conversion of state vectors into orbital elements %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

rmag = sqrt(dot(rvec,rvec)); % position magnitude
vmag = sqrt(dot(vvec,vvec)); % velocity magnitude

rhat = rvec/rmag; % position unit vector
vhat = vvec/vmag; % velocity unit vector

hvec = cross(rvec,vvec); % angular momentum vector
hmag = sqrt(dot(hvec,hvec)); % angular momentum magnitude
hhat = hvec/hmag; % angular momentum unit vector

nvec = cross([0 0 1],h); % node vector
nmag = sqr

evec = ((vmag^2 - mu/rmag)*rvec - dot(rvec,vvec)*vvec)/mu; % eccentricity vector
emag = sqrt(dot(evec,evec)); % eccentricity magnitude

E = vmag^2/2 - mu/rmag; % specific mechanical energy

if emag ~= 1
    a = -mu/2E;
    p = a(1-emag^2);
else
    p = hmag^2/mu;
    a = Inf;
end;

i = acos(hvec(3)/hmag);

